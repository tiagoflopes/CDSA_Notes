- *Setting the Stage* - It's all about planning and preparation. Making certain our environment is ready for effective threat hunting, which might involve enabling extensive logging across our system and ensuring threat hunting tools are correctly set up. Also stay informed about the most recent cyber threats and familiarize ourselves with threat actor profiles.

- *Formulating Hypotheses* - Involves making educated predictions that will guide our threat hunting journey. These hypotheses can stem from various sources, like recent threat intelligence, industry updates, alerts from security tools, or even our professional intuition. We strive to make those testable to guide us where to search and what to look for.

- *Designing the Hunt* - This includes recognizing the specific data sources that need analysis, the methodologies and tools we'll use and the particular IoCs or patters we'll hunt for. At this point we might also create custom scripts and queries, and utilize dedicated threat hunting tools.

- *Data Gathering and Examination* - This is where the active threat hunt occurs. It involves collecting necessary data, such as log files, network traffic data, endpoint data, and then analyzing this data using the predetermined methodologies and tools. Our goal is to find evidence that either supports or refutes our initial hypotheses.

- *Evaluating Findings and Testing Hypotheses* - Now, interpret the results. This could involve confirming or disproving the hypotheses, understanding the behavior of any detected threats, identifying affected systems or determining the potential impact of the threat.

- *Mitigating Threats* - If we confirm a threat, we must undertake remediation actions. This could involve isolating affected systems, eliminating malware, patching vulnerabilities or modifying configurations. Our goal is to eradicate the threat and limit  any potential damage.

- *After the Hunt* - Document and share the findings, methods and outcomes. This might involve updating threat intelligence platforms, enhancing detection rules, refining incident response playbooks or improving security policies.

- *Continuous Learning and Enhancement* - This is not a one-time task, but a continuous process of learning and refinement. Each threat hunting cycle should feed into the next, allowing for continuous improvement of hypotheses, methodologies and tools based on the evolving threat landscape and the organization's changing risk profile.

**Threat hunting is a delicate balance of art and science.** It demands technical prowess, creativity and a profound understanding of both the organization's environment and the broader threat landscape.

## The Threat Hunting Process vs Emotet

This is a demonstration of how the threat hunting process could have been applies to hunt for [emotet malware](https://www.cisa.gov/news-events/cybersecurity-advisories/aa20-280a) within an organization.
- *Setting the Stage*: During the planning and preparation phase, the threat hunting team extensively researches the Emotet malware's TTPs by studying previous attack campaigns, analyzing malware samples and reviewing specific threat intelligence reports. They gain a deep understanding of Emotet's infection vectors, such as malicious email attachments or links, and the exploitation of vulnerabilities in software or operating systems. The team identifies critical assets and systems that are commonly targeted by Emotet, such as endpoints with administrative privileges or email servers.
    
- *Formulating Hypotheses*: Hypotheses in the context of Emotet threat hunting might be based on known Emotet IoCs or patterns observed in previous attacks. For example, a hypothesis could be that Emotet is using a new phishing technique to distribute malicious payloads via compromised email accounts. This hypothesis could be derived from recent threat intelligence reports highlighting similar Emotet campaigns or based on alerts triggered by email security systems detecting suspicious email attachments. The hypothesis should be specific, such as "Emotet is using compromised email accounts to send phishing emails with malicious Word documents containing macros."
    
- *Designing the Hunt*: In the design phase, the threat hunting team determines the relevant data sources and collection methods to validate or invalidate the Emotet-related hypotheses. They may decide to analyze email server logs, network traffic logs, endpoint logs, or sandboxed malware samples. They define search queries, filters, and correlation rules to extract information related to Emotet's specific characteristics, such as email subject lines, attachment types, or network communication patterns associated with Emotet infections. They leverage threat intelligence feeds to identify Emotet-related IoCs, such as known command-and-control (C2) server addresses or file hashes associated with Emotet payloads.
    
- *Data Gathering and Examination*: The team collects and analyzes data from various sources to detect Emotet-related activities. For example, they might examine email server logs to identify patterns of suspicious email attachments or analyze network traffic captures to detect communication with known Emotet C2 servers. They apply data analysis techniques, such as email header analysis, network traffic pattern analysis, or behavioral analysis, to identify potential Emotet infections. They utilize tools like email forensics software, network packet analyzers, or sandbox environments to extract relevant information from the collected data and uncover hidden indicators of Emotet activity.
    
- *Evaluating Findings and Testing Hypotheses*: The team evaluates the findings from data analysis to confirm or refute the initial Emotet-related hypotheses. For example, they might discover a series of emails with similar subject lines and attachment types associated with Emotet campaigns, confirming the hypothesis of ongoing Emotet phishing activities. They might also find evidence of network connections to known Emotet C2 servers, supporting the hypothesis of an active Emotet infection. The team conducts deeper investigations to understand the behavior of the identified Emotet infections, assess the scope of the compromise, and determine the potential impact on the organization's systems and data.
    
- *Mitigating Threats*: If Emotet infections are confirmed, the team takes immediate remediation actions. They isolate affected systems from the network to prevent further spread of the malware and potential data exfiltration. They deploy endpoint protection tools to detect and remove Emotet malware from compromised systems. Additionally, they analyze compromised email accounts to identify and remove unauthorized access. They patch or mitigate vulnerabilities exploited by Emotet to prevent future infections. Network configurations are adjusted to block communication with known Emotet C2 servers or malicious domains.
    
- *After the Hunt*: Once the Emotet threat hunting cycle concludes, the team documents their findings, methodologies, and outcomes. They update threat intelligence platforms with new Emotet-related IoCs and share relevant information with other teams or external partners to enhance their collective defense against Emotet. They improve detection rules within security tools based on the observed Emotet attack patterns and refine incident response playbooks to streamline future incident handling. Lessons learned from the Emotet hunt are incorporated into security policies and procedures, and training programs are adjusted to enhance the organization's overall defenses against Emotet and similar malware.
    
- *Continuous Learning and Enhancement*: Threat hunting for Emotet is an ongoing process that requires continuous learning and improvement. After each Emotet threat hunting cycle, the team reviews the effectiveness of their hypotheses, methodologies, and tools. They analyze the results and adjust their approach based on lessons learned and new Emotet-related threat intelligence. For example, they might enhance their hunting techniques by incorporating advanced behavior-based detection mechanisms or machine learning algorithms specifically designed to identify Emotet's evolving TTPs. They actively participate in industry conferences, attend training sessions, and collaborate with other threat hunting teams to stay updated on the latest Emotet attack techniques and defensive strategies.
