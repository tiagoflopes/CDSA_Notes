Windows operating systems function in 2 main modes:
- User mode - where most apps and user processes operate. They have limited access to system resources and must interact with the OS through APIs. They are isolated from each other and cannot directly access hardware nor critical functions.
- Kernel mode - a highly privileged mode where the Windows kernel runs. It has unrestricted access to system resources, hardware and critical functions. Device drivers also run in kernel mode.

## Architecture at a High Level

A simplified version of Windows' architecture.
![[windows_architecture.webp]]

##### User-mode Components
- *System Support Processes* - provide crucial functionalities and services such as logon processes, Session Manager and Service Control Manager.
- *Service Processes* - host Windows services like the Windows Update Service, Task Scheduler and Print Spooler services.
- *User Applications* - processes created by user programs, which interact with the OS via APIs.
- *Environment Subsystems* - provide execution environments for specific types of applications or processes.
- *Subsystem DDLs* - translate documented functions into appropriate internal native system calls.

##### Kernel-mode Components
- *Executive* - gets accessed through functions from NTDLL.dll. It consists of I/O Manager, Object Manager, Security Reference, Process Manager and others. It runs some tests first and then passes the call to kernel/device driver.
- *Kernel* - manages system resources, providing low-level services like thread scheduling, interrupt and exception dispatching and multiprocessor synchronization.
- *Device Driver* - enable the OS to interact with hardware devices.
- *Hardware Abstraction Layer (HAL)* - provides an abstraction layer between the hardware devices and the OS.
- *Windowing and Graphics System (Win32k.sys)* - responsible for managing the GUI and rendering visual elements on the screen.

## API Call Flow

asdasd

## Portable Executable

asdasd

##### PE Sections
asdasd

## Processes

asdasd

## Dynamic-link Library (DDL)

asdasd

##### Import Functions
asdasd

##### Export Functions
asdasd
